#!/usr/bin/env bash
#
# Author: Anders Evenrud <andersevenrud@gmail.com>
#

declare -A linecount
declare -A filecount

git_files=`git ls-files --exclude-standard`
count=`echo $git_files | wc -l`
total=0

for f in $git_files; do
  ext="${f##*.}"
  filename="${f%.*}"

  if [[ "$filename" == "package-lock.json" || "$ext" =~ ^jpg|jpeg|png|bmp|ico|lock$ ]]; then
    continue
  fi

  if [[ "$ext" == "$filename" || "$filename" == "" ]]; then
    ext="*"
  fi

  lines=`cat $f 2>/dev/null | wc -l`
  linecount[$ext]=$(expr ${linecount[$ext]} + $lines)
  filecount[$ext]=$(expr ${filecount[$ext]} + 1)
  total=$(expr $total + $lines)
done

for k in "${!linecount[@]}"; do
  echo "${k}: ${linecount[$k]} in ${filecount[$k]} file(s)"
done

echo -e "\n${total} in ${count} file(s)"
